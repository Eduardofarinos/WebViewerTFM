<!DOCTYPE html>
<html>
  <head>
    <title>WMS Capabilities Parsing</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <link rel="stylesheet" href="https://openlayers.org/en/v4.1.1/css/ol.css" type="text/css">
    <!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
    <script src="https://openlayers.org/en/v4.1.1/build/ol.js"></script>
    <style>
      .log-container {
        height: 400px;
        overflow: scroll;
      }
    </style>
  </head>
  <body>
    <pre class="log-container"><code id="log"></code></pre>
    <button type="button" onclick="loadDoc()">Request data</button>
    <p id="demo"></p>
    <script>
      var parser = new ol.format.WMSCapabilities();
      fetch('http://wms.magrama.es/sig/Agricultura/Evapotranspiracion/wms.aspx?request=GetCapabilities&service=WMS').then(function(response) {
        return response.text();
      }).then(function(text) {
        var result = parser.read(text);
        document.getElementById('log').innerText = JSON.stringify(result, null, 2);
      });
      function loadDoc() {
        var xhttp = new XMLHttpRequest();

        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("demo").innerHTML = JSON.stringify(this.responseText, null, 2);
            console.log(JSON.stringify(this.responseText, null, 2));
          }
        };
        xhttp.open("GET", "http://wms.magrama.es/sig/Agricultura/Evapotranspiracion/wms.aspx?request=GetCapabilities&service=WMS", true);
        xhttp.send();
      }
    </script>
  </body>
</html>
